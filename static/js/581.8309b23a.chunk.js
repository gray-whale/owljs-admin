"use strict";(self.webpackChunkmonitor_admin=self.webpackChunkmonitor_admin||[]).push([[581],{850:(e,t,a)=>{a.d(t,{$6:()=>l,DF:()=>r,kD:()=>s});var n=a(4689);const l=e=>n.Z.get("web/sourcemap",e),s=e=>n.Z.post("web/sourcemap",e),r=e=>n.Z.get("web/sourcemap/".concat(e))},1172:(e,t,a)=>{a.d(t,{L:()=>l,U:()=>n});const n=(e,t)=>{let a=[];try{const n=t=>{if(a.push(t),(null===t||void 0===t?void 0:t.key)===e)throw new Error("GOT IT!");if(null!==t&&void 0!==t&&t.children&&(null===t||void 0===t?void 0:t.children.length)>0){for(let e=0;e<(null===t||void 0===t?void 0:t.children.length);e++)n(t.children[e]);a.pop()}else a.pop()};for(let e=0;e<t.length;e++)n(t[e]);return[]}catch(n){return a.map((e=>e.label))}};function l(e,t){const a=(new TextEncoder).encode(t).buffer,n=new Blob([a],{type:"text/plain;charset=utf-8"}),l=new FileReader;l.readAsDataURL(n),l.onload=t=>{const a=document.createElement("a");a.href=t.target.result,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}},581:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var n=a(3552),l=a(3414),s=a(2351),r=a(5722),c=a(1773),o=a(2641),i=a(6473),d=a(2954),u=a(2499),p=a(6998),h=a.n(p),m=a(2791),f=a(1087),x=a(850),g=a(732),j=a(6776),v=a(3070),y=a(7828),Z=a(9389),w=a(891),b=a(4941),S=a(3329);const k=e=>{const[t]=v.Z.useForm(),[a,n]=(0,m.useState)([]),[l,s]=(0,m.useState)(""),[i]=(0,f.lr)(),[d,u]=r.ZP.useMessage(),p={accept:".js.map",multiple:!1,maxCount:1,onRemove:e=>{const t=a.indexOf(e),l=a.slice();l.splice(t,1),n(l)},beforeUpload:e=>{const t=new FileReader;return t.readAsBinaryString(e),t.onload=function(){s(this.result)},n([...a,e]),!1},fileList:a};return(0,S.jsxs)(y.Z,{title:"\u4e0a\u4f20SourceMap",placement:"right",width:500,closable:!1,open:e.open,extra:(0,S.jsx)(c.Z,{children:(0,S.jsx)(g.Z,{onClick:e.onClose})}),children:[u,(0,S.jsxs)(v.Z,{layout:"vertical",form:t,onFinish:async a=>{const n=i.get("appId");if(n)try{await(0,x.kD)({filename:a.name,sourcemap:l,site_type:"web",appId:n,release:a.release}),t.resetFields(),r.ZP.success("\u521b\u5efa\u6210\u529f"),e.onSuccess()}catch(s){console.log(s)}else d.open({type:"error",content:"appId\u4e0d\u80fd\u4e3a\u7a7a!"})},initialValues:{type:1},children:[(0,S.jsx)(v.Z.Item,{label:"js sourcemap\u6587\u4ef6\u540d",name:"name",rules:[{required:!0}],children:(0,S.jsx)(Z.Z,{})}),(0,S.jsx)(v.Z.Item,{label:"\u4e0a\u4f20 Sourcemap \u6587\u4ef6",name:"dragger",rules:[{required:!0}],children:(0,S.jsx)(v.Z.Item,{name:"dragger",valuePropName:"fileList",getValueFromEvent:e=>Array.isArray(e)?e:null===e||void 0===e?void 0:e.fileList,noStyle:!0,children:(0,S.jsxs)(b.Z,{...p,children:[(0,S.jsx)("p",{className:"ant-upload-drag-icon",children:(0,S.jsx)(j.Z,{})}),(0,S.jsx)("p",{className:"ant-upload-text",children:"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u6b64\u5904\u4e0a\u4f20"}),(0,S.jsx)("p",{className:"ant-upload-hint",children:"\u53ea\u652f\u6301.js.map\u6587\u4ef6"})]})})}),(0,S.jsx)(v.Z.Item,{label:"Release",name:"release",rules:[{required:!0}],children:(0,S.jsx)(w.Z,{showSearch:!0,allowClear:!0,placeholder:"\u9009\u62e9\u6216\u8f93\u5165\u5bf9\u5e94\u7248\u672c",optionFilterProp:"children",onChange:e=>{console.log("selected ".concat(e))},onSearch:e=>{console.log("search:",e)},filterOption:(e,t)=>{var a;return(null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},options:[{value:"jack",label:"Jack"},{value:"lucy",label:"Lucy"},{value:"tom",label:"Tom"}]})}),(0,S.jsx)(v.Z.Item,{children:(0,S.jsx)(o.ZP,{type:"primary",htmlType:"submit",children:"\u786e\u5b9a"})})]})]})};var C=a(1172);const I=()=>{const[e,t]=(0,m.useState)(""),[a,p]=(0,m.useState)(""),[g,j]=(0,m.useState)(1),[v,y]=(0,m.useState)(10),[Z,w]=(0,m.useState)(0),[b,I]=(0,m.useState)([]),[L]=(0,f.lr)(),[z,P]=(0,m.useState)(!1);(0,m.useEffect)((()=>{(async()=>{const e=L.get("appId");if(e){const a=await(0,n.BN)(e);a&&200===a.code&&(t(a.data.apiKey),p(a.data.apiSecret))}})()}),[]);const E=(e,t)=>{e.stopPropagation(),h()(t),r.ZP.success("\u5df2\u590d\u5236")},V=[{title:"\u6587\u4ef6\u540d",dataIndex:"filename",width:50},{title:"release",dataIndex:"release",width:100},{title:"\u6587\u4ef6\u5927\u5c0f",dataIndex:"filesize",width:50},{title:"\u4e0a\u4f20\u65f6\u95f4",dataIndex:"createdAt",width:100},{title:"\u64cd\u4f5c",width:100,render:(e,t)=>(0,S.jsx)(c.Z,{size:"middle",children:(0,S.jsx)(o.ZP,{type:"link",onClick:e=>A(e,t.key.toString()),children:"\u4e0b\u8f7d Sourcemap"})})}],A=async(e,t)=>{const a=await(0,x.DF)(t);a.data&&(0,C.L)("".concat(a.data.filename,".js.map"),a.data.sourcemap)},F=async()=>{const e=await(0,x.$6)({pageNum:g,pageSize:v});if(e.data){w(e.data.total);const t=[];e.data.data.forEach((e=>{t.push({key:e.smId,release:e.release,createdAt:e.createdAt,filename:e.filename,filesize:e.filesize})})),I(t)}};(0,m.useEffect)((()=>{F()}),[]),(0,m.useEffect)((()=>{F()}),[g,v]);const T={showSizeChanger:!0,onChange:(e,t)=>{j(e),y(t)},defaultCurrent:g,total:Z};return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{style:{background:"#ffffff",padding:"12px 16px"},children:[(0,S.jsx)(u.Z,{level:5,children:"\u81ea\u52a8\u4e0a\u4f20\u5bc6\u94a5"}),(0,S.jsxs)("div",{children:[(0,S.jsxs)("span",{children:[(0,S.jsx)("span",{style:{color:"#86909c"},children:"API Key:"}),"\xa0\xa0",e," ",(0,S.jsx)(l.Z,{style:{marginLeft:"8px"},onClick:t=>E(t,e)})]})," ",(0,S.jsxs)("span",{style:{marginLeft:"16px"},children:[" ",(0,S.jsx)("span",{style:{color:"#86909c"},children:"API Token:"}),"\xa0\xa0",a," ",(0,S.jsx)(l.Z,{style:{marginLeft:"8px"},onClick:e=>E(e,a)})]})]})]}),(0,S.jsxs)(i.Z,{title:"sourcemap\u5217\u8868",style:{marginTop:"20px"},children:[(0,S.jsx)(o.ZP,{type:"primary",icon:(0,S.jsx)(s.Z,{}),onClick:e=>P(!0),children:"\u4e0a\u4f20Sourcemap"}),(0,S.jsx)(d.Z,{style:{marginTop:"12px"},pagination:T,columns:V,dataSource:b})]}),(0,S.jsx)(k,{onSuccess:()=>{P(!1),F()},open:z,onClose:()=>P(!1)})]})}},6776:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7462),l=a(2791);const s={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"};var r=a(4291),c=function(e,t){return l.createElement(r.Z,(0,n.Z)({},e,{ref:t,icon:s}))};const o=l.forwardRef(c)},2351:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7462),l=a(2791);const s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};var r=a(4291),c=function(e,t){return l.createElement(r.Z,(0,n.Z)({},e,{ref:t,icon:s}))};const o=l.forwardRef(c)}}]);
//# sourceMappingURL=581.8309b23a.chunk.js.map